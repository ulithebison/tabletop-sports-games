<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabletop Sports Games Archive - 3311+ Games</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #2ecc71 0%, #3498db 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        /* Header */
        header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            text-align: center;
        }

        h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 1.1em;
        }

        .header-links {
            margin-top: 15px;
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .header-link {
            color: #3498db;
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s;
        }

        .header-link:hover {
            color: #2ecc71;
            text-decoration: underline;
        }

        /* Main Layout */
        .main-layout {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 30px;
        }

        /* Sidebar Filters */
        .sidebar {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            height: fit-content;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
            position: sticky;
            top: 20px;
        }

        .sidebar h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .filter-search {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.9em;
            margin-bottom: 20px;
            transition: border-color 0.3s;
        }

        .filter-search:focus {
            outline: none;
            border-color: #3498db;
        }

        .filter-section {
            margin-bottom: 25px;
        }

        .filter-section h4 {
            color: #555;
            margin-bottom: 10px;
            font-size: 1em;
            font-weight: 600;
        }

        .filter-options {
            max-height: 250px;
            overflow-y: auto;
        }

        .filter-option {
            display: flex;
            align-items: center;
            padding: 8px 0;
            cursor: pointer;
            transition: background 0.2s;
            border-radius: 4px;
            padding-left: 5px;
        }

        .filter-option:hover {
            background: #f5f5f5;
        }

        .filter-option input[type="checkbox"] {
            margin-right: 10px;
            cursor: pointer;
            width: 16px;
            height: 16px;
        }

        .filter-option label {
            cursor: pointer;
            font-size: 0.9em;
            color: #555;
            flex: 1;
        }

        .filter-count {
            color: #999;
            font-size: 0.85em;
            margin-left: auto;
        }

        .show-more {
            color: #3498db;
            cursor: pointer;
            font-size: 0.85em;
            margin-top: 8px;
            display: inline-block;
            text-decoration: underline;
        }

        .year-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 10px;
        }

        .year-inputs input {
            padding: 8px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 0.9em;
        }

        .quick-year {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .quick-year label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 0.9em;
            color: #555;
        }

        .quick-year input[type="radio"] {
            margin-right: 8px;
        }

        .clear-filters {
            width: 100%;
            padding: 12px;
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
            margin-top: 20px;
        }

        .clear-filters:hover {
            background: #ff5252;
        }

        /* Main Content */
        .main-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }

        /* Top Bar */
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .search-container {
            flex: 1;
            min-width: 250px;
        }

        .search-bar {
            width: 100%;
            padding: 12px 20px;
            font-size: 1em;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            transition: all 0.3s;
        }

        .search-bar:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .view-toggle {
            display: flex;
            gap: 10px;
        }

        .view-btn {
            padding: 10px 20px;
            background: #f5f5f5;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .view-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }

        .view-btn:hover:not(.active) {
            background: #e8e8e8;
        }

        .results-info {
            color: #666;
            font-size: 1em;
            margin-bottom: 20px;
        }

        /* Loading & Error States */
        .loading, .error, .no-results {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .loading {
            font-size: 1.2em;
        }

        .error {
            color: #ff6b6b;
        }

        /* Grid View */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .game-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s;
            cursor: pointer;
            display: flex;
            flex-direction: column;
        }

        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            border-color: #3498db;
        }

        .game-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            background: linear-gradient(135deg, #2ecc71 0%, #3498db 100%);
        }

        .game-content {
            padding: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .game-title {
            font-size: 1.2em;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
            line-height: 1.3;
        }

        .game-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 12px;
        }

        .tag {
            padding: 4px 10px;
            background: #f0f0f0;
            color: #555;
            border-radius: 15px;
            font-size: 0.8em;
            font-weight: 500;
        }

        .tag.sport { background: #e3f2fd; color: #1976d2; }
        .tag.type { background: #f3e5f5; color: #7b1fa2; }

        .game-meta {
            display: flex;
            flex-direction: column;
            gap: 8px;
            font-size: 0.9em;
            color: #666;
            margin-bottom: 12px;
        }

        .game-meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .game-meta-item strong {
            color: #444;
            min-width: 80px;
        }

        .game-description {
            font-size: 0.9em;
            color: #666;
            line-height: 1.5;
            margin-top: auto;
        }

        /* List View */
        .games-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 30px;
        }

        .game-card.list-view {
            flex-direction: row;
            cursor: pointer;
            padding: 15px 20px;
        }

        .game-card.list-view .game-image {
            display: none;
        }

        .game-card.list-view .game-content {
            flex: 1;
            padding: 0;
        }

        .game-card.list-view .game-title {
            font-size: 1.1em;
            margin-bottom: 8px;
        }

        .game-card.list-view .game-meta {
            flex-direction: row;
            flex-wrap: wrap;
            gap: 15px;
        }

        .game-card.list-view .game-meta-item {
            margin: 0;
        }

        .game-card.list-view .game-description {
            display: none;
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .page-btn {
            padding: 10px 16px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            color: #555;
        }

        .page-btn:hover:not(:disabled) {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }

        .page-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
        }

        .page-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .main-layout {
                grid-template-columns: 1fr;
            }

            .sidebar {
                position: static;
            }

            .games-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            h1 {
                font-size: 1.8em;
            }

            .games-grid {
                grid-template-columns: 1fr;
            }

            .game-card.list-view {
                flex-direction: column;
            }

            .game-card.list-view .game-image {
                width: 100%;
                height: 200px;
            }

            .top-bar {
                flex-direction: column;
                align-items: stretch;
            }

            .view-toggle {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <h1>üéÆ Tabletop Sports Games Archive</h1>
            <p class="subtitle">Discover 3311+ BoardGameGeek Sports Games</p>
            <div class="header-links">
                <a href="contact.html" class="header-link">üìß Contact</a>
            </div>
        </header>

        <!-- Main Layout -->
        <div class="main-layout">
            <!-- Sidebar Filters -->
            <aside class="sidebar">
                <h3>üîç Filters</h3>
                
                <input type="text" class="filter-search" id="filterSearch" placeholder="Search in filters...">

                <!-- Source Filter (MOVED TO TOP) -->
                <div class="filter-section">
                    <h4>Source</h4>
                    <div class="filter-options" id="sourceFilters"></div>
                </div>

                <!-- Sport Filter -->
                <div class="filter-section">
                    <h4>Sport</h4>
                    <div class="filter-options" id="sportFilters"></div>
                    <span class="show-more" id="showMoreSports" style="display: none;">+ Show all</span>
                </div>

                <!-- Type Filter -->
                <div class="filter-section">
                    <h4>Type</h4>
                    <div class="filter-options" id="typeFilters"></div>
                    <span class="show-more" id="showMoreTypes" style="display: none;">+ Show all</span>
                </div>

                <!-- Year Filter -->
                <div class="filter-section">
                    <h4>Year</h4>
                    <div class="year-inputs">
                        <input type="number" id="yearFrom" placeholder="From" min="1900" max="2030">
                        <input type="number" id="yearTo" placeholder="To" min="1900" max="2030">
                    </div>
                    <div class="quick-year">
                        <label><input type="radio" name="yearQuick" value="recent"> Last 5 years (2020-2025)</label>
                        <label><input type="radio" name="yearQuick" value="decade"> Last 10 years (2015-2025)</label>
                        <label><input type="radio" name="yearQuick" value="classic"> Classic (&lt;2000)</label>
                        <label><input type="radio" name="yearQuick" value="all" checked> All</label>
                    </div>
                </div>

                <!-- Players Filter -->
                <div class="filter-section">
                    <h4>Players</h4>
                    <div class="filter-options" id="playersFilters"></div>
                </div>

                <!-- Complexity Filter -->
                <div class="filter-section">
                    <h4>Complexity</h4>
                    <div class="filter-options" id="complexityFilters"></div>
                </div>

                <!-- Playtime Filter -->
                <div class="filter-section">
                    <h4>Playtime</h4>
                    <div class="filter-options" id="playtimeFilters"></div>
                </div>

                <button class="clear-filters" onclick="clearAllFilters()">Clear All Filters</button>
            </aside>

            <!-- Main Content -->
            <main class="main-content">
                <!-- Top Bar -->
                <div class="top-bar">
                    <div class="search-container">
                        <input type="text" class="search-bar" id="searchBar" placeholder="Search games by name or description...">
                    </div>
                    <div class="view-toggle">
                        <button class="view-btn active" id="gridViewBtn" onclick="setView('grid')">
                            <span>üî≤</span> Grid View
                        </button>
                        <button class="view-btn" id="listViewBtn" onclick="setView('list')">
                            <span>‚â°</span> List View
                        </button>
                    </div>
                </div>

                <div class="results-info" id="resultsInfo">Loading games...</div>

                <!-- Games Container -->
                <div id="gamesContainer">
                    <div class="loading">Loading games from database...</div>
                </div>

                <!-- Pagination -->
                <div class="pagination" id="pagination"></div>
            </main>
        </div>
    </div>

    <script>
        // Global variables
        let allGames = [];
        let filteredGames = [];
        let currentPage = 1;
        const gamesPerPage = 50;
        let currentView = 'grid';
        
        // Filter state
        let filters = {
            sports: [],
            types: [],
            yearFrom: null,
            yearTo: null,
            players: [],
            complexity: [],
            playtime: [],
            source: [],
            search: ''
        };

        // Initialize
        async function init() {
            await loadGames();
            setupEventListeners();
        }

        // Load games from Supabase
        async function loadGames() {
            try {
                // Load ALL games - Supabase default limit is 1000, so we need to specify more
                const { data, error } = await window.supabaseClient
                    .from('games')
                    .select('*')
                    .order('name', { ascending: true })
                    .limit(10000); // Load up to 10000 games

                if (error) throw error;

                allGames = data;
                filteredGames = [...allGames];
                
                buildFilters();
                displayGames();
                updateResultsInfo();
            } catch (error) {
                console.error('Error loading games:', error);
                document.getElementById('gamesContainer').innerHTML = 
                    '<div class="error">Error loading games. Please refresh the page.</div>';
            }
        }

        // Build filter options
        function buildFilters() {
            buildSportFilters();
            buildTypeFilters();
            buildPlayersFilters();
            buildComplexityFilters();
            buildPlaytimeFilters();
            buildSourceFilters();
        }

        // Build Sport filters
        function buildSportFilters() {
            const sportCounts = {};
            allGames.forEach(game => {
                const sports = game.sport ? game.sport.split(';').map(s => s.trim()) : [];
                sports.forEach(sport => {
                    sportCounts[sport] = (sportCounts[sport] || 0) + 1;
                });
            });

            const sortedSports = Object.entries(sportCounts)
                .sort((a, b) => b[1] - a[1]);

            const container = document.getElementById('sportFilters');
            const showMore = document.getElementById('showMoreSports');
            
            const displayCount = 10;
            sortedSports.forEach(([sport, count], index) => {
                const option = createFilterOption('sport', sport, count, index >= displayCount);
                container.appendChild(option);
            });

            if (sortedSports.length > displayCount) {
                showMore.style.display = 'inline-block';
                showMore.onclick = () => {
                    container.querySelectorAll('.filter-option').forEach(el => el.style.display = 'flex');
                    showMore.style.display = 'none';
                };
            }
        }

        // Build Type filters
        function buildTypeFilters() {
            const typeCounts = {};
            allGames.forEach(game => {
                const types = game.type ? game.type.split(';').map(t => t.trim()) : [];
                types.forEach(type => {
                    typeCounts[type] = (typeCounts[type] || 0) + 1;
                });
            });

            const sortedTypes = Object.entries(typeCounts)
                .sort((a, b) => b[1] - a[1]);

            const container = document.getElementById('typeFilters');
            const showMore = document.getElementById('showMoreTypes');
            
            const displayCount = 10;
            sortedTypes.forEach(([type, count], index) => {
                const option = createFilterOption('type', type, count, index >= displayCount);
                container.appendChild(option);
            });

            if (sortedTypes.length > displayCount) {
                showMore.style.display = 'inline-block';
                showMore.onclick = () => {
                    container.querySelectorAll('.filter-option').forEach(el => el.style.display = 'flex');
                    showMore.style.display = 'none';
                };
            }
        }

        // Build Players filters
        function buildPlayersFilters() {
            const playerOptions = [
                { value: 'solo', label: 'Solo (1 player)', count: 0 },
                { value: '2', label: '2 players', count: 0 },
                { value: '3-4', label: '3-4 players', count: 0 },
                { value: '5+', label: '5+ players', count: 0 }
            ];

            allGames.forEach(game => {
                if (!game.players) return;
                const players = game.players.toLowerCase();
                
                if (players === '1') playerOptions[0].count++;
                if (players === '2' || players.includes('2')) playerOptions[1].count++;
                if (players.match(/[3-4]/)) playerOptions[2].count++;
                if (players.match(/[5-9]/) || players.includes('6+')) playerOptions[3].count++;
            });

            const container = document.getElementById('playersFilters');
            playerOptions.forEach(({ value, label, count }) => {
                const option = createFilterOption('players', value, count);
                option.querySelector('label').textContent = label;
                container.appendChild(option);
            });
        }

        // Build Complexity filters
        function buildComplexityFilters() {
            const complexityCounts = {};
            allGames.forEach(game => {
                if (game.complexity) {
                    const comp = game.complexity.trim();
                    complexityCounts[comp] = (complexityCounts[comp] || 0) + 1;
                }
            });

            const container = document.getElementById('complexityFilters');
            ['Simple', 'Medium', 'Complex', 'Expert'].forEach(complexity => {
                const count = complexityCounts[complexity] || 0;
                if (count > 0) {
                    const option = createFilterOption('complexity', complexity, count);
                    container.appendChild(option);
                }
            });
        }

        // Build Playtime filters
        function buildPlaytimeFilters() {
            const playtimeOptions = [
                { value: '<30', label: 'Quick (<30 min)', count: 0 },
                { value: '30-60', label: 'Medium (30-60 min)', count: 0 },
                { value: '60+', label: 'Long (60+ min)', count: 0 }
            ];

            allGames.forEach(game => {
                if (!game.playtime) return;
                const time = parseInt(game.playtime);
                
                if (time < 30) playtimeOptions[0].count++;
                else if (time >= 30 && time <= 60) playtimeOptions[1].count++;
                else if (time > 60) playtimeOptions[2].count++;
            });

            const container = document.getElementById('playtimeFilters');
            playtimeOptions.forEach(({ value, label, count }) => {
                const option = createFilterOption('playtime', value, count);
                option.querySelector('label').textContent = label;
                container.appendChild(option);
            });
        }

        // Build Source filters
        function buildSourceFilters() {
            const sourceCounts = {
                'bgg': allGames.filter(g => g.source === 'bgg').length,
                'manual': allGames.filter(g => g.source === 'manual').length
            };

            const container = document.getElementById('sourceFilters');
            [
                { value: 'bgg', label: 'BoardGameGeek' },
                { value: 'manual', label: 'Hidden Games' }
            ].forEach(({ value, label }) => {
                const count = sourceCounts[value];
                const option = createFilterOption('source', value, count);
                option.querySelector('label').textContent = label;
                container.appendChild(option);
            });
        }

        // Create filter option element
        function createFilterOption(filterType, value, count, hidden = false) {
            const div = document.createElement('div');
            div.className = 'filter-option';
            if (hidden) div.style.display = 'none';
            
            div.innerHTML = `
                <input type="checkbox" id="${filterType}-${value}" value="${value}" 
                       onchange="handleFilterChange('${filterType}', '${value}', this.checked)">
                <label for="${filterType}-${value}">${value}</label>
                <span class="filter-count">(${count})</span>
            `;
            
            return div;
        }

        // Handle filter changes
        function handleFilterChange(filterType, value, checked) {
            if (checked) {
                filters[filterType + 's'].push(value);
            } else {
                filters[filterType + 's'] = filters[filterType + 's'].filter(v => v !== value);
            }
            
            applyFilters();
        }

        // Apply all filters
        function applyFilters() {
            filteredGames = allGames.filter(game => {
                // Search filter
                if (filters.search) {
                    const searchLower = filters.search.toLowerCase();
                    const nameMatch = game.name && game.name.toLowerCase().includes(searchLower);
                    const descMatch = game.description && game.description.toLowerCase().includes(searchLower);
                    if (!nameMatch && !descMatch) return false;
                }

                // Sport filter
                if (filters.sports.length > 0) {
                    const gameSports = game.sport ? game.sport.split(';').map(s => s.trim()) : [];
                    if (!filters.sports.some(sport => gameSports.includes(sport))) return false;
                }

                // Type filter
                if (filters.types.length > 0) {
                    const gameTypes = game.type ? game.type.split(';').map(t => t.trim()) : [];
                    if (!filters.types.some(type => gameTypes.includes(type))) return false;
                }

                // Year filter
                if (filters.yearFrom && game.year < filters.yearFrom) return false;
                if (filters.yearTo && game.year > filters.yearTo) return false;

                // Players filter
                if (filters.players.length > 0) {
                    const players = game.players ? game.players.toLowerCase() : '';
                    let matches = false;
                    
                    filters.players.forEach(filter => {
                        if (filter === 'solo' && players === '1') matches = true;
                        if (filter === '2' && (players === '2' || players.includes('2'))) matches = true;
                        if (filter === '3-4' && players.match(/[3-4]/)) matches = true;
                        if (filter === '5+' && (players.match(/[5-9]/) || players.includes('6+'))) matches = true;
                    });
                    
                    if (!matches) return false;
                }

                // Complexity filter
                if (filters.complexity.length > 0) {
                    if (!filters.complexity.includes(game.complexity)) return false;
                }

                // Playtime filter
                if (filters.playtime.length > 0) {
                    const time = parseInt(game.playtime) || 0;
                    let matches = false;
                    
                    filters.playtime.forEach(filter => {
                        if (filter === '<30' && time < 30) matches = true;
                        if (filter === '30-60' && time >= 30 && time <= 60) matches = true;
                        if (filter === '60+' && time > 60) matches = true;
                    });
                    
                    if (!matches) return false;
                }

                // Source filter
                if (filters.source.length > 0) {
                    if (!filters.source.includes(game.source)) return false;
                }

                return true;
            });

            currentPage = 1;
            displayGames();
            updateResultsInfo();
        }

        // Clear all filters
        function clearAllFilters() {
            filters = {
                sports: [],
                types: [],
                yearFrom: null,
                yearTo: null,
                players: [],
                complexity: [],
                playtime: [],
                source: [],
                search: ''
            };

            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            document.getElementById('yearFrom').value = '';
            document.getElementById('yearTo').value = '';
            document.querySelector('input[name="yearQuick"][value="all"]').checked = true;
            document.getElementById('searchBar').value = '';
            document.getElementById('filterSearch').value = '';

            applyFilters();
        }

        // Display games
        function displayGames() {
            const container = document.getElementById('gamesContainer');
            const startIndex = (currentPage - 1) * gamesPerPage;
            const endIndex = startIndex + gamesPerPage;
            const gamesToShow = filteredGames.slice(startIndex, endIndex);

            if (gamesToShow.length === 0) {
                container.innerHTML = '<div class="no-results">No games found matching your filters.</div>';
                document.getElementById('pagination').innerHTML = '';
                return;
            }

            const containerClass = currentView === 'grid' ? 'games-grid' : 'games-list';
            const cardClass = currentView === 'grid' ? '' : 'list-view';

            container.innerHTML = `
                <div class="${containerClass}">
                    ${gamesToShow.map(game => createGameCard(game, cardClass)).join('')}
                </div>
            `;

            displayPagination();
        }

        // Create game card
        function createGameCard(game, extraClass = '') {
            const sports = game.sport ? game.sport.split(';').map(s => s.trim()) : [];
            const types = game.type ? game.type.split(';').map(t => t.trim()) : [];
            
            const shortText = game.subtitle || 
                             (game.description ? game.description.substring(0, 150) + '...' : 'No description available');

            const imageUrl = game.thumbnail_url || game.image_url || '';

            return `
                <div class="game-card ${extraClass}" onclick="goToGameDetail(${game.id})">
                    ${imageUrl ? `<img src="${imageUrl}" alt="${game.name}" class="game-image" loading="lazy">` : 
                                 '<div class="game-image"></div>'}
                    <div class="game-content">
                        <div class="game-title">${game.name}</div>
                        
                        <div class="game-tags">
                            ${sports.map(s => `<span class="tag sport">${s}</span>`).join('')}
                            ${types.map(t => `<span class="tag type">${t}</span>`).join('')}
                        </div>
                        
                        <div class="game-meta">
                            ${game.year ? `<div class="game-meta-item"><strong>Year:</strong> ${game.year}</div>` : ''}
                            ${game.players ? `<div class="game-meta-item"><strong>Players:</strong> ${game.players}</div>` : ''}
                            ${game.playtime ? `<div class="game-meta-item"><strong>Playtime:</strong> ${game.playtime} min</div>` : ''}
                            ${game.complexity ? `<div class="game-meta-item"><strong>Complexity:</strong> ${game.complexity}</div>` : ''}
                        </div>
                        
                        <div class="game-description">${shortText}</div>
                    </div>
                </div>
            `;
        }

        // Display pagination
        function displayPagination() {
            const totalPages = Math.ceil(filteredGames.length / gamesPerPage);
            const pagination = document.getElementById('pagination');

            if (totalPages <= 1) {
                pagination.innerHTML = '';
                return;
            }

            let html = `
                <button class="page-btn" onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>
                    ‚Üê Previous
                </button>
            `;

            // Show page numbers
            const maxButtons = 7;
            let startPage = Math.max(1, currentPage - Math.floor(maxButtons / 2));
            let endPage = Math.min(totalPages, startPage + maxButtons - 1);
            
            if (endPage - startPage < maxButtons - 1) {
                startPage = Math.max(1, endPage - maxButtons + 1);
            }

            if (startPage > 1) {
                html += `<button class="page-btn" onclick="changePage(1)">1</button>`;
                if (startPage > 2) html += '<span>...</span>';
            }

            for (let i = startPage; i <= endPage; i++) {
                html += `<button class="page-btn ${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</button>`;
            }

            if (endPage < totalPages) {
                if (endPage < totalPages - 1) html += '<span>...</span>';
                html += `<button class="page-btn" onclick="changePage(${totalPages})">${totalPages}</button>`;
            }

            html += `
                <button class="page-btn" onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>
                    Next ‚Üí
                </button>
            `;

            pagination.innerHTML = html;
        }

        // Change page
        function changePage(page) {
            const totalPages = Math.ceil(filteredGames.length / gamesPerPage);
            if (page < 1 || page > totalPages) return;
            
            currentPage = page;
            displayGames();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Update results info
        function updateResultsInfo() {
            const startIndex = (currentPage - 1) * gamesPerPage + 1;
            const endIndex = Math.min(currentPage * gamesPerPage, filteredGames.length);
            const total = filteredGames.length;

            document.getElementById('resultsInfo').textContent = 
                `Showing ${startIndex}-${endIndex} of ${total} games`;
        }

        // Set view
        function setView(view) {
            currentView = view;
            document.getElementById('gridViewBtn').classList.toggle('active', view === 'grid');
            document.getElementById('listViewBtn').classList.toggle('active', view === 'list');
            displayGames();
        }

        // Go to game detail
        function goToGameDetail(gameId) {
            window.location.href = `game-detail.html?id=${gameId}`;
        }

        // Setup event listeners
        function setupEventListeners() {
            // Search bar
            const searchBar = document.getElementById('searchBar');
            let searchTimeout;
            searchBar.addEventListener('input', (e) => {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    filters.search = e.target.value;
                    applyFilters();
                }, 300);
            });

            // Filter search
            const filterSearch = document.getElementById('filterSearch');
            filterSearch.addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                document.querySelectorAll('.filter-option').forEach(option => {
                    const label = option.querySelector('label').textContent.toLowerCase();
                    option.style.display = label.includes(searchTerm) ? 'flex' : 'none';
                });
            });

            // Year inputs
            document.getElementById('yearFrom').addEventListener('change', (e) => {
                filters.yearFrom = e.target.value ? parseInt(e.target.value) : null;
                applyFilters();
            });

            document.getElementById('yearTo').addEventListener('change', (e) => {
                filters.yearTo = e.target.value ? parseInt(e.target.value) : null;
                applyFilters();
            });

            // Quick year filters
            document.querySelectorAll('input[name="yearQuick"]').forEach(radio => {
                radio.addEventListener('change', (e) => {
                    const currentYear = new Date().getFullYear();
                    switch(e.target.value) {
                        case 'recent':
                            filters.yearFrom = 2020;
                            filters.yearTo = 2025;
                            break;
                        case 'decade':
                            filters.yearFrom = 2015;
                            filters.yearTo = 2025;
                            break;
                        case 'classic':
                            filters.yearFrom = null;
                            filters.yearTo = 1999;
                            break;
                        default:
                            filters.yearFrom = null;
                            filters.yearTo = null;
                    }
                    applyFilters();
                });
            });
        }

        // Initialize on page load
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
